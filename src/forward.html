<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="https://cdn.glitch.com/8194e9d5-f0a3-4d19-9253-7797a0366c1c%2Fcat.png?1536335780609">
    <title>üêà AffiliCats ‚Äî Find the cutest cats online!</title>
    <style>
      html {
        box-sizing: border-box;
      }

      *, *:before, *:after {
        box-sizing: inherit;
      }

      body {
        font-size: 14pt;
        font-family: "Benton Sans", "Helvetica Neue", helvetica, arial, sans-serif;
        margin: .5em;
      }

      h1 {
        font-style: italic;
        color: #373fff;
      }

      p {
        margin-left: 1.5em;
      }

      .offline {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        height: 5em;
        background-color: #ccc;
        text-align: center;
      }

      #hourglass {
        position: absolute;
        left: .5em;
      }

      #hourglass.spin {
        animation-name: spinning;
        animation-duration: 1s;
        animation-iteration-count: infinite;
        animation-timing-function: ease-in-out;
      }

      @keyframes spinning {
        from {transform:rotate(0deg);}
        to {transform:rotate(360deg);}
      }

      a.noclick {
        pointer-events: none;
        cursor: prohibited;
      }
    </style>
    <link id="favicon" rel="icon" href="https://cdn.glitch.com/8194e9d5-f0a3-4d19-9253-7797a0366c1c%2Fcat.svg?1536143545629" type="image/svg">
    <meta name="theme-color" content="#373fff">
  </head>
  <body>
    <header>
      <h1>üêà AffiliCats</h1>
      <p>
        <span id="hourglass">‚è≥</span> Forwarding you to <a href="#" id="forward"></a> in <span id="seconds"></span> seconds‚Ä¶
      </p>
    </header>
    <div hidden class="offline">‚ö†Ô∏è Seems like we're offline at the moment</div>
    <footer>¬© 2018 AffiliCats</footer>
    <script type="text/javascript">
      const REDIRECT_TIMEOUT = 10;
      const offline = document.querySelector('.offline');
      const hourglass = document.getElementById('hourglass');
      const seconds = document.getElementById('seconds');
      seconds.textContent = REDIRECT_TIMEOUT;
      const forwardLink = document.getElementById('forward');

      const Timer = function(callback, delay) {
        let remaining = delay;
        let timerId;
        let start;

        this.running = true;

        this.counter = 0;

        this.pause = () => {
          this.running = false;
          window.clearTimeout(timerId);
          remaining -= new Date() - start;
        };

        this.resume = () => {
          this.running = true;
          start = new Date();
          window.clearTimeout(timerId);
          timerId = window.setTimeout(callback, remaining);
        };

        window.setInterval(() => {
          if (this.running) {
            this.counter++;
            seconds.textContent = REDIRECT_TIMEOUT - this.counter;
          }
        }, 1000);

        this.resume();
      }

      const params = new URLSearchParams(document.location.search);
      const url = new URL(params.get('url'));
      forwardLink.textContent = url.host;
      forwardLink.href = url;

      const timer = new Timer(() => {
        document.location.href = url;
      }, REDIRECT_TIMEOUT * 1000);

      const online = navigator.onLine;
      offline.hidden = online;
      if (online) {
        hourglass.classList.add('spin');
        forwardLink.classList.remove('noclick');
      } else {
        hourglass.classList.remove('spin');
        forwardLink.classList.add('noclick');
      }

      window.addEventListener('offline', () => {
        offline.hidden = false;
        hourglass.classList.remove('spin');
        forwardLink.classList.add('noclick');
        timer.pause();
      });

      window.addEventListener('online', () => {
        offline.hidden = true;
        hourglass.classList.add('spin');
        forwardLink.classList.remove('noclick');
        timer.resume();
      });

    </script>
  </body>
</html>
