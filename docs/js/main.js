(()=>{var b=Math.floor;const a="Felis silvestris catus",c=document.querySelector(".offline"),d=document.querySelector("main"),e=document.querySelector("input[type=\"search\"]"),f=document.querySelector("button"),g=document.getElementById("cat"),h=document.querySelector(".install");let i,j;const k=new IntersectionObserver(a=>{a.forEach(a=>{if(0<a.intersectionRatio){const b=a.target;if(k.unobserve(b),"IMG"===b.nodeName)return b.src=`${b.dataset.src}${/\?/.test(b.dataset.src)?"&":"?"}${Math.random().toString().substr(2)}`;const c=b.classList;if(c.contains("photos"))return p(b);if(c.contains("reviews"))return o(b);if(c.contains("offers"))return n(b)}})}),l=async a=>{const b=`https://commons.wikimedia.org/w/api.php
        ?action=query
        &generator=categorymembers
        &gcmlimit=max
        &gcmtype=file
        &gcmtitle=Category:${encodeURIComponent(a.replace(/\s/g," "))}
        &prop=imageinfo
        &iiurlwidth=500
        &iiprop=extmetadata|url
        &iiextmetadatafilter=ImageDescription
        &format=json&origin=*`.replace(/\n\s*/g,"");return fetch(b).then(a=>{if(!a.ok)throw new TypeError(`Could not load ${b}`);return a.json()}).then(a=>a&&a.query&&a.query.pages?Object.keys(a.query.pages).map(b=>{let c=a.query.pages[b];try{c=c.imageinfo[0];const a=c.thumburl,b=c.descriptionshorturl,d=c.thumbwidth,e=c.thumbheight,f=c.extmetadata.ImageDescription.value;return{url:b,src:a,description:f,width:d,height:e}}catch(a){}}).filter(a=>"undefined"!=typeof a):void 0).catch(a=>console.error(a))},m=(a,c,d)=>{const f=j&&"pushManager"in j,g=document.createDocumentFragment();a.forEach((d,h)=>{var i=Math.round;const j=document.importNode(c.content,!0),k=j.querySelector("figure img");k.alt=`Illustrative ${e.value.toLowerCase()} image`,k.classList.add("lazyload"),k.dataset.src=d.src;const l=j.querySelector("figcaption");if(l.textContent=(l.innerHTML=d.description,l.textContent),/took too long to load/.test(d.description))return;const m=j.querySelector(".pricedrop");f?(m.hidden=!1,m.querySelector("input").addEventListener("input",a=>{const b=a.target;if(b.checked){const a=b.parentNode;a.innerHTML=a.innerHTML.replace("\uD83D\uDECE","\u23F3"),(async()=>{const c=await s();b.disabled=c,b.dataset.active="false",a.innerHTML=a.innerHTML.replace("\u23F3","\uD83D\uDECE"),m.querySelector("span").hidden=!c})()}})):m.hidden=!0;const n=j.querySelector(".stars");n.textContent=`Cuteness rating: ${"\uD83D\uDE3B".repeat(b(5*Math.random())+1)}`;const o=j.querySelector(".price");o.textContent=`Price range: ${"\uD83D\uDCB0".repeat(b(3*Math.random())+1)}`;const p=j.querySelector(".outlink");p.href=`./forward.html?url=${encodeURIComponent(d.url)}`,p.textContent="View Deal";const a=j.querySelector(".tabs");a.addEventListener("click",()=>{q(a)});const r=a.querySelectorAll(".tab label"),t=a.querySelectorAll(".tabcontent");a.querySelectorAll(".tab input").forEach((a,b)=>{const c=Math.random().toString().substr(2);a.name=`tabgroup${h}`,a.id=c,r[b].setAttribute("for",c),t[b].setAttribute("aria-labelledby",c)});const u=a.querySelector(".map"),v=i(1e5*(90*((.5>Math.random()?-1:1)*Math.random())))/1e5,w=i(1e5*(180*((.5>Math.random()?-1:1)*Math.random())))/1e5;u.dataset.src=`https://maps.googleapis.com/maps/api/staticmap
          ?autoscale=1
          &size=500x350
          &maptype=terrain
          &key=AIzaSyBWZnCRi6oar3MTjR0HkR1lK52_mTe0Rks
          &format=png
          &markers=size:small%7Ccolor:0xfffb00%7C${v},${w}`.replace(/\n\s*/g,""),u.alt=`Map centered on latitude ${v} and longitude ${w}`,a.querySelector(".lat").textContent=v,a.querySelector(".long").textContent=w,g.appendChild(j)}),d.innerHTML="",d.appendChild(g)},n=a=>{const c=document.createDocumentFragment(),d=`https://www.random.org/integers/
        ?num=${b(4*Math.random())+2}
        &min=5&max=20&col=1&base=10&format=plain&rnd=new`.replace(/\n\s*/g,"");fetch(d).then(a=>{if(!a.ok)throw new TypeError(`Could not load ${d}`);return a.text()}).then(b=>{let d=b.split(/\n/g);d.splice(-1,1),d.map(a=>isNaN(parseInt(a,10))?a:parseInt(a+"9",10)).sort((c,a)=>c-a).map((a,b)=>{const d=document.createElement("li");d.textContent=/\d+/.test(a)?`From $${a} at Affiliate ${b}`:a,c.appendChild(d)}),a.innerHTML="",a.appendChild(c)}).catch(a=>console.error(a))},o=a=>{const c=document.createDocumentFragment(),d=[];for(let c=0,e=b(6*Math.random())+2;c<e;c++){const a=`https://baconipsum.com/api/?type=all-meat&paras=${b(3*Math.random())+1}&start-with-lorem=1&random=${c}`;d[c]=fetch(a).then(b=>{if(!b.ok)throw new TypeError(`Could not load ${a}`);return b.json()}).then(a=>`<li>${a.map(a=>`<p>${a}</p>`).join("")}</li>`).catch(a=>console.error(a))}Promise.all(d).then(a=>a.join("")).then(b=>{const d=document.createElement("ul");d.innerHTML=b,c.appendChild(d),a.innerHTML="",a.appendChild(c)})},p=a=>{const c=document.createDocumentFragment(),d=document.createElement("div");d.classList.add("gallery"),c.appendChild(d);const f=[];for(let c=0,d=b(15*Math.random())+2;c<d;c++){const a=10*(b(10*Math.random())+20),d=10*(b(5*Math.random())+20),e=`https://placekitten.com/${a}/${d}?random=${c}`;f[c]=fetch(e).then(a=>{if(!a.ok)throw new TypeError(`Could not load ${e}`);return a.blob()}).then(b=>({width:a,height:d,blob:b}))}Promise.all(f).then(b=>{b.forEach(a=>{const b=new Image(a.width,a.height);b.alt=`Illustrative ${e.value.toLowerCase()} image`,b.src=URL.createObjectURL(a.blob),d.appendChild(b)}),a.innerHTML="",a.appendChild(c)}).catch(a=>console.error(a))},q=(a=!1)=>{const b=a?a.querySelectorAll(".lazyload"):document.querySelectorAll(".lazyload");b.forEach(a=>{k.observe(a)})};window.addEventListener("offline",()=>{c.hidden=!1,e.disabled=!0,f.disabled=!0,document.querySelectorAll("input[data-active=\"true\"]").forEach(a=>{a.disabled=!0})}),window.addEventListener("online",()=>{c.hidden=!0,e.disabled=!1,f.disabled=!1,document.querySelectorAll("input[data-active=\"true\"]").forEach(a=>{a.disabled=!1}),"false"===d.dataset.hydrated&&u(),q()});const r=()=>{document.querySelector("form").addEventListener("submit",a=>{a.preventDefault(),u()}),window.addEventListener("beforeinstallprompt",a=>{a.preventDefault(),i=a,h.disabled=!1,h.hidden=!1}),h.addEventListener("click",()=>{h.disabled=!0,h.hidden=!0,i.prompt(),i.userChoice.then(a=>{"accepted"===a.outcome?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),i=null})});for(let a=0;3>a;a++){const b=g.content,c=b.querySelectorAll(".tab label"),e=b.querySelectorAll(".tabcontent");b.querySelectorAll(".tab input").forEach((b,d)=>{const f=Math.random().toString().substr(2);b.name=`tabgroup${a}`,b.id=f,c[d].setAttribute("for",f),e[d].setAttribute("aria-labelledby",f)}),d.appendChild(document.importNode(b,!0))}const a=navigator.onLine;c.hidden=a,e.disabled=!a,f.disabled=!a,a&&u(),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(a=>{j=a,j.onupdatefound=t,t()}).catch(a=>console.error(a))},s=async()=>{if(!j||!("pushManager"in j))return!1;const a=a=>{const b="=".repeat((4-a.length%4)%4),c=(a+b).replace(/\-/g,"+").replace(/_/g,"/"),d=window.atob(c),e=new Uint8Array(d.length);for(let b=0;b<d.length;++b)e[b]=d.charCodeAt(b);return e};return j.pushManager.getSubscription().then(b=>{if(b)return b;const c=a("BHuCD9Ym4yXI9Fk0KHrRcPgH2iQOXhoWbzWtm4GQocD1zGYz4IXyazINE_-T4pEojrAgqoGoRnxUgX5CAuguRGo");return j.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:c})}).then(a=>(fetch("https://affilicats-push.glitch.me/push/sendNotification",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({subscription:a,delay:5,ttl:0})}),fetch("https://affilicats-push.glitch.me/push/register",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({subscription:a})}).then(a=>a.ok))).catch(a=>(console.error(a),!1))},t=async()=>{const a=async a=>{const b=new Request(a,{mode:"no-cors"});return fetch(b).then(a=>c.put(b,a)).catch(a=>console.error(a))},b=await caches.keys(),c=await caches.open(b.filter(a=>/^offline_/.test(a))[0]);for(let b=0;b<localStorage.length;b++){const c=localStorage.key(b);"polyfill"===localStorage.getItem(c)&&("IntersectionObserver"===c?a("https://unpkg.com/intersection-observer@0.5.0/intersection-observer.js"):"PWACompat"===c?a("https://unpkg.com/pwacompat@2.0.7/pwacompat.min.js"):"URLSearchParams"===c?a("https://unpkg.com/url-search-params@1.1.0/build/url-search-params.js"):void 0)}},u=async()=>{const b=new URLSearchParams(document.location.search),c=b.get("query");c&&!e.value&&(e.value=c),c||e.value||(e.value=a);const f=e.value||a,h=await l(f);Array.isArray(h)&&0<h.length?(d.dataset.hydrated="true",f!==a&&history.pushState({},"",`${document.location.origin}${document.location.pathname}?query=${encodeURIComponent(f)}`),m(h,g,d)):d.innerHTML=`<p>😥 No results found.</p>
          <p>Try anything that is a
          <a href="https://commons.wikimedia.org/wiki/Category:Topics">
          Wikimedia Categorie</a>. Maybe try
          <a href="./?query=Elephants">Elephants</a> 🐘</p>`,q()};r()})();